webpackJsonp([42],{"7Cm5":function(e,t,o){"use strict";function a(e){o("KAXh")}Object.defineProperty(t,"__esModule",{value:!0});var r=o("vG8E"),s=o("TB17"),i=o("VU/8"),n=a,l=i(r.a,s.a,!1,n,null,null);t.default=l.exports},KAXh:function(e,t,o){var a=o("qaS+");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("rjj0")("40a1f40f",a,!0)},TB17:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h1",{staticClass:"site-settings-title"},[e._v("\n        网站设置\n    ")]),o("Form",{ref:"siteForm",attrs:{model:e.formData,rules:e.formRule,"label-width":120}},[o("FormItem",{attrs:{label:"网站名称",prop:"name"}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("Input",{attrs:{placeholder:"请输入网站名称"},model:{value:e.formData.name,callback:function(t){e.formData.name="string"==typeof t?t.trim():t},expression:"formData.name"}})],1)],1)],1),o("FormItem",{attrs:{label:"备案号",prop:"icp"}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("Input",{attrs:{placeholder:"请输入备案号"},model:{value:e.formData.icp,callback:function(t){e.formData.icp="string"==typeof t?t.trim():t},expression:"formData.icp"}})],1)],1)],1),o("FormItem",{attrs:{label:"网站标题",prop:"title"}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("Input",{attrs:{placeholder:"请输入网站标题"},model:{value:e.formData.title,callback:function(t){e.formData.title="string"==typeof t?t.trim():t},expression:"formData.title"}})],1)],1)],1),o("FormItem",{attrs:{label:"logo",prop:"logoURL"}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("div",{staticClass:"logo-img-box"},[o("img",{attrs:{src:e.formData.logoURL}})]),o("Upload",{attrs:{action:e.uploadURL,"on-success":e.onUploadCallback,accept:"image/*","show-upload-list":!1,"before-upload":e.beforeUpload,name:"upFile",format:["jpg","jpeg","png"],"on-format-error":e.onFormatError}},[o("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[e._v("上传")])],1)],1)],1)],1),o("FormItem",{attrs:{label:"网站关键词",prop:"keywords"}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("Input",{attrs:{placeholder:"请输入网站关键词，以逗号分隔"},model:{value:e.formData.keywords,callback:function(t){e.formData.keywords="string"==typeof t?t.trim():t},expression:"formData.keywords"}})],1)],1)],1),o("FormItem",{attrs:{label:"网站描述",prop:"description"}},[o("Row",[o("Col",{attrs:{span:"12"}},[o("Input",{attrs:{placeholder:"请输入网站描述"},model:{value:e.formData.description,callback:function(t){e.formData.description="string"==typeof t?t.trim():t},expression:"formData.description"}})],1)],1)],1),o("Form-item",{attrs:{"label-width":0}},[o("Button",{attrs:{size:"large",type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)],1)},r=[],s={render:a,staticRenderFns:r};t.a=s},"qaS+":function(e,t,o){t=e.exports=o("FZ+f")(!1),t.push([e.i,".site-settings-title{font-size:22px;margin:12px 0}.logo-img-box{border:1px solid #e2e2e2;margin-bottom:12px}.logo-img-box img{width:164px;height:36px}",""])},vG8E:function(e,t,o){"use strict";var a=o("mvHQ"),r=o.n(a),s=o("FhoZ"),i=o.n(s),n=o("V8bM"),l=o("y8ae");t.a={asyncData:function(e){return n.a.getSiteInfo({client:e.req}).then(function(e){var t=e.data.siteConfig;return{uploadURL:i.a.uploadURL,formData:{name:t.name,icp:t.icp,title:t.title,keywords:t.keywords,description:t.description,logoURL:t.logoURL},formRule:{name:[{required:!0,message:"请输入网站名称",trigger:"blur"}],icp:[{required:!0,message:"请输入备案号",trigger:"blur"}],title:[{required:!0,message:"请输入网站标题",trigger:"blur"}],keywords:[{required:!0,message:"请输入网站关键词，以逗号分隔",trigger:"blur"}],description:[{required:!0,message:"请输入网站描述",trigger:"blur"}],logoURL:[{required:!0,message:"请上传网站logo",trigger:"blur"}]}}})},methods:{beforeUpload:function(e){e.size>i.a.sizeLimit&&this.$Message.error({duration:i.a.messageDuration,closable:!0,content:"图片大小要小于"+i.a.sizeLimitTip})},onFormatError:function(){this.$Message.error({duration:i.a.messageDuration,closable:!0,content:"不是有效的图片格式"})},onUploadCallback:function(e,t){if(e)if(e.errNo===l.a.SUCCESS){var o=e.data.url;this.formData.logoURL=o}else e.errNo===l.a.ERROR?this.$Message.error({duration:i.a.messageDuration,closable:!0,content:e.msg}):e.errNo===l.a.LOGIN_TIMEOUT&&(location.href="/signin?ref="+encodeURIComponent(location.href))},onSubmit:function(){var e=this;return this.$refs.siteForm.validate(function(t){if(t){var o=e;o.formData.keywords=o.formData.keywords.replace(/，/g,","),n.a.setKeyVaueConfig({body:{key:"site_config",value:r()(o.formData)}}).then(function(e){e.errNo===l.a.ERROR?o.$Message.error({duration:i.a.messageDuration,closable:!0,content:e.msg}):e.errNo===l.a.LOGIN_TIMEOUT?location.href="/signin?ref="+encodeURIComponent(location.href):e.errNo===l.a.SUCCESS&&o.$Message.success({duration:i.a.messageDuration,closable:!0,content:e.msg})}).catch(function(e){o.$Message.error({duration:i.a.messageDuration,closable:!0,content:e.message||e.msg})})}}),!1}},head:function(){return{title:"网站设置"}},layout:"admin"}},y8ae:function(e,t,o){"use strict";t.a={SUCCESS:0,ERROR:1,LOGIN_TIMEOUT:1001,IN_ACTIVE:1002}}});
//# sourceMappingURL=site.e937ecd1401df14f63ea.js.map